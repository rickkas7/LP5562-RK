<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LP5562-RK: LP5562-RK</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LP5562-RK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LP5562-RK </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><em><a class="el" href="class_l_p5562.html" title="Class for the LP5562 LED driver. ">LP5562</a> I2C LED Driver for Particle devices</em></p>
<p>There are several possibilities for indicator RGB LEDs:</p>
<ul>
<li>Direct connection to PWM outputs</li>
<li>Serial LEDs like NeoPixels (WS2812)</li>
<li>I2C LED drivers</li>
</ul>
<p>Direct PWM is the least expensive, but when you are using RGB LEDs you'll quickly run out of available PWM channels. You're pretty much limited to one additional RGB LED on most devices.</p>
<p>NeoPixels are a great option as you can string together dozens of LEDs off a single GPIO. There are a few downsides:</p>
<ul>
<li>You need to have 3.6V or higher. You can't run them off 3.3V.</li>
<li>The NeoPixel library runs for long periods of time with interrupts disabled for long strands, which may affect performance of other code.</li>
</ul>
<p>The third option is to use an I2C LED driver. That's what this library is for. It allows the use of the TI <a class="el" href="class_l_p5562.html" title="Class for the LP5562 LED driver. ">LP5562</a> I2C LED driver from a Particle device. Why it this useful?</p>
<ul>
<li>It runs at 3.3V</li>
<li>Uses cheap off-the-shelf RGB LEDs</li>
<li>You can include up to 4 of them on the I2C bus</li>
<li>It can drive LEDs up to 25.5 mA, great for large indicator LEDs</li>
<li>It has a programmable constant current driver so you don't need current limiting resistors</li>
<li>It's a programmable smart controller so many LED patterns can be made without intervention from the MCU</li>
</ul>
<p>What's the downside? It does add a chip ($1.14 in single quantities). The biggest challenge is that it's only available in a DSBGA12 package. This is a really, really tiny 3x4 BGA (ball grid array) chip. 1.648 mm x 1.248 mm. It's barely larger than an 0805 resistor, but with 12 pins. It can only be reflowed; it's obviously not possible to solder with a soldering iron.</p>
<p>On the plus side, you can put one of these on your board and it takes up less space than 3x 0603 current limiting resistors.</p>
<p>While it's designed to drive an RGB LED plus one extra LED (white), it actually can drive any four independent LEDs. There are a couple benefits of using "indicator mode":</p>
<ul>
<li>You can drive 4x LEDs up to 25.5 mA</li>
<li>Only uses I2C, no GPIO</li>
<li>Full programmable to be on/dim/off, plus programmable patterns like blink or breathe</li>
</ul>
<h3>The library</h3>
<p>Using the LP5562-RK library is just a matter of adding the library to your project and initializing it:</p>
<div class="fragment"><div class="line">#include &quot;LP5562-RK.h&quot;</div><div class="line"></div><div class="line">LP5562 ledDriver;</div><div class="line"></div><div class="line">void setup() {</div><div class="line">    ledDriver.withLEDCurrent(5.0).begin();</div><div class="line"></div><div class="line">    ledDriver.setBreathe(false, true, true, 20, 0, 255);</div><div class="line">}</div><div class="line"></div><div class="line">void loop() {</div><div class="line">}</div></div><!-- fragment --><p>You normally allocate the object as a global object:</p>
<div class="fragment"><div class="line">LP5562 ledDriver;</div></div><!-- fragment --><p>In setup(), initialize the object. There are some options that you configure fluent-style then call the begin() method:</p>
<div class="fragment"><div class="line">ledDriver.withLEDCurrent(5.0).begin();</div></div><!-- fragment --><p>There are methods to set a constant color, blink, alternating blink, and breathe. This call does cyan breathing:</p>
<div class="fragment"><div class="line">ledDriver.setBreathe(false, true, true, 20, 0, 255);</div></div><!-- fragment --><p>The options left to right are:</p>
<ul>
<li>red (disabled)</li>
<li>green (enabled)</li>
<li>blue (enabled) (green + blue = cyan)</li>
<li>20 the number of half milliseconds per step (10 milliseconds)</li>
<li>0 starting brightness</li>
<li>255 ending brightness</li>
</ul>
<p><a href="https://rickkas7.github.io/LP5562-RK/index.html">Full browsable API docs</a> are available. The calls are extensively documented in the .h file. There's also a copy of the HTML docs in the docs subdirectory.</p>
<p>The three example programs illustrate all of the features.</p>
<h3>I2C addressing</h3>
<p>The <a class="el" href="class_l_p5562.html" title="Class for the LP5562 LED driver. ">LP5562</a> has two address select lines to allow you to connect four to a single I2C bus, using address 0x30 to 0x33.</p>
<p>Because of the closeness of the BGA balls if you use the external clock you'll probably be limited to using the single I2C address 0x30. The reason is that you'll probably need to route ground through pins B1 (AD1), B2 (AD0), to B3 (GND).</p>
<div class="image">
<img src="ExtClock.png" alt="ExtClock.png"/>
<div class="caption">
External Clock</div></div>
<p> If you're not using an external clock and using the same power supply for VCC and VDD, then life is much easier, and all addresses are easily routed:</p>
<p>Address 0 (AD1 = 0, AD0 = 0, 0x30):</p>
<div class="image">
<img src="Addr0.png" alt="Addr0.png"/>
<div class="caption">
Address 0</div></div>
<p> Address 1 (AD1 = 0, AD0 = 1, 0x31):</p>
<div class="image">
<img src="Addr1.png" alt="Addr1.png"/>
<div class="caption">
Address 1</div></div>
<p> Address 2 (AD1 = 1, AD0 = 0, 0x32):</p>
<div class="image">
<img src="Addr2.png" alt="Addr2.png"/>
<div class="caption">
Address 2</div></div>
<p> Address 3 (AD1 = 1, AD0 = 1, 0x33):</p>
<div class="image">
<img src="Addr3.png" alt="Addr3.png"/>
<div class="caption">
Address 3</div></div>
<h3>RGB Demo Board</h3>
<p>I made a simple demo board to test and illustrate the use of the chip.</p>
<div class="image">
<img src="board-image.jpg" alt="board-image.jpg"/>
<div class="caption">
Board Image</div></div>
<p> Here's the schematic.</p>
<div class="image">
<img src="schematic1.png" alt="schematic1.png"/>
<div class="caption">
Schematic</div></div>
 <div class="image">
<img src="schematic2.png" alt="schematic2.png"/>
<div class="caption">
Schematic</div></div>
<p> And the board. It's an Adafruit Feather form-factor, intended to be used in a double or tripler with a Gen 3 Particle device (Argon, Boron, or Xenon). Male header pins go on the bottom side.</p>
<div class="image">
<img src="board.png" alt="board.png"/>
<div class="caption">
Board</div></div>
<p> Close-up of the LED circuitry:</p>
<div class="image">
<img src="board-close.png" alt="board-close.png"/>
<div class="caption">
Board Close</div></div>
<p> The eagle subdirectory contains the open source design:</p>
<ul>
<li>LedDriverTest1.sch (schematic)</li>
<li>LedDriverTest1.brd (board layout)</li>
<li>LedDriverTest1v1.zip (gerbers)</li>
<li>LedDriverTest1.lbr (library with all of the components used on the board)</li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Quantity  </th><th class="markdownTableHeadNone">Item  </th><th class="markdownTableHeadNone" colspan="2">Examp   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone"><a class="el" href="class_l_p5562.html" title="Class for the LP5562 LED driver. ">LP5562</a>  </td><td class="markdownTableBodyNone"><a href="https://www.digikey.com/product-detail/en/texas-instruments/LP5562TMX-NOPB/296-39061-1-ND/5142961">LP5562TMX/NOPB</a>  </td><td class="markdownTableBodyRight">$1.14   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">RGB LED  </td><td class="markdownTableBodyNone"><a href="https://www.digikey.com/product-detail/en/cree-inc/CLMVC-FKA-CL1D1L71BB7C3C3/CLMVC-FKA-CL1D1L71BB7C3C3CT-ND/9094273 CLMVC-FKA-CL1D1L71BB7C3C3">Cree CLMVC-FKA-CL1D1L71BB7C3C3</a>  </td><td class="markdownTableBodyRight">$0.19   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1  </td><td class="markdownTableBodyNone">White LED  </td><td class="markdownTableBodyNone"><a href="https://www.digikey.com/product-detail/en/lite-on-inc/LTW-C191DS5/160-2239-1-ND/7708913">Lite-On Inc. LTW-C191DS5</a>  </td><td class="markdownTableBodyRight">$0.55   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyNone">2  </td><td class="markdownTableBodyNone">10K Resistor 0603  </td><td class="markdownTableBodyNone"><a href="https://www.digikey.com/product-detail/en/panasonic-electronic-components/ERJ-PA3J103V/P10KBZCT-ND/5036237">Panasonic ERJ-PA3J103V</a>  </td><td class="markdownTableBodyRight">$0.10   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyNone"></td><td class="markdownTableBodyNone">Male header pins 0.1" &lt;/td&gt;
    &lt;td class="markdownTableBodyNone"&gt; [Sullins PRPC040SAAN-RC](https://www.digikey.com/product-detail/en/PRPC040SAAN-RC/S1011EC-40-ND/2775214) &lt;/td&gt;
    &lt;td class="markdownTableBodyRight"&gt;   </td></tr>
</table>
<h3>Indicator Demo Board</h3>
<p>This demo board tests 4 discrete LEDs instead of using an RGB LED. I made it using T-1 (3mm) through hole LEDs because I had a kit of them so I could use 3 20mA LEDs and 1 10mA LEDs.</p>
<div class="image">
<img src="board2-image.jpg" alt="board2-image.jpg"/>
<div class="caption">
Indicator Board</div></div>
<p> Schematic:</p>
<div class="image">
<img src="board2-schematic.png" alt="board2-schematic.png"/>
<div class="caption">
Indicator Schematic</div></div>
<p> Board:</p>
<div class="image">
<img src="board2.png" alt="board2.png"/>
<div class="caption">
Indicator Board</div></div>
<p> The main difference between indicator mode and RGB mode is how the engines are set up. Because there are four LEDs and 3 engines, indicator mode sets up the three engines with common patterns:</p>
<ul>
<li>Blink</li>
<li>Fast blink</li>
<li>Breathe</li>
</ul>
<p>Then you can assign any LED to be on, dim, off, or one of the three available patterns. This provides a lot of flexibility given the hardware limitations of the <a class="el" href="class_l_p5562.html" title="Class for the LP5562 LED driver. ">LP5562</a>. Of course the full <a class="el" href="class_l_p5562.html" title="Class for the LP5562 LED driver. ">LP5562</a> programming API is available as well if you want to go crazy with the customization.</p>
<p>If you are using LEDs with different current requirements you can use the <code>withLEDCurrent()</code> overload with separate settings for red, green, blue, and white.</p>
<div class="fragment"><div class="line">ledDriver.withLEDCurrent(20.0, 20.0, 20.0, 10.0).begin();</div></div><!-- fragment --><p>To use indicator mode, use <code>setIndicatorMode()</code>.</p>
<div class="fragment"><div class="line">ledDriver.setIndicatorMode();</div></div><!-- fragment --><p>To set an LED, use one of the setLedMapping methods:</p>
<div class="fragment"><div class="line">ledDriver.setLedMappingR(LP5562::REG_LED_MAP_DIRECT, 0);</div><div class="line">ledDriver.setLedMappingG(LP5562::REG_LED_MAP_ENGINE_1);</div><div class="line">ledDriver.setLedMappingB(LP5562::REG_LED_MAP_ENGINE_2);</div><div class="line">ledDriver.setLedMappingW(LP5562::REG_LED_MAP_ENGINE_3);</div></div><!-- fragment --><ul>
<li><code><a class="el" href="class_l_p5562.html#aaf0a7ca699d74306ed4622081354b288" title="Sets the LED to direct PWM setting mode. ">LP5562::REG_LED_MAP_DIRECT</a></code> sets a direct PWM value. 0 is off, 255 is full brightness, and values in between are dimmed.</li>
<li><code><a class="el" href="class_l_p5562.html#a6ce5bc35ce703b3af20be6df5a3e5e67" title="Sets the LED to be controlled by engine 1. ">LP5562::REG_LED_MAP_ENGINE_1</a></code> is a normal blink.</li>
<li><code><a class="el" href="class_l_p5562.html#a5a47a4abcce94fad6953ee063bd080c5" title="Sets the LED to be controlled by engine 2. ">LP5562::REG_LED_MAP_ENGINE_2</a></code> is a fast blink.</li>
<li><code><a class="el" href="class_l_p5562.html#ad3aa43433c650996622f8fd11c4071d3" title="Sets the LED to be controlled by engine 3. ">LP5562::REG_LED_MAP_ENGINE_3</a></code> is breathing. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
